<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
    <title>TERABOX LINKS | PREMIUM</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    
    <style>
        :root {
            --primary: #2563eb;
            --bg-dark: #0a0a0c;
            --card-bg: rgba(20, 20, 25, 0.95);
            --wa-color: #25d366;
            --wa-dark: #128c7e;
            --wa-bg-chat: #e5ddd5;
        }
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-dark);
            color: #f8fafc;
            margin: 0;
            padding: 0;
            scroll-behavior: smooth;
            overflow-x: hidden;
            min-height: 100vh;
        }
        .glass {
            background: var(--card-bg);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border: 1px solid rgba(255, 255, 255, 0.08);
        }
        .sticky-header {
            position: sticky;
            top: 0;
            z-index: 100;
            background-color: var(--bg-dark);
            padding-bottom: 4px;
        }
        .video-container {
            position: relative;
            padding-bottom: 56.25%;
            background: #000;
        }
        .controls-bar {
            height: 44px;
            margin-top: -1px;
            border-top: none;
            border-radius: 0 0 12px 12px;
        }
        @keyframes pulse-yellow {
            0% { box-shadow: 0 0 0 0 rgba(234, 179, 8, 0.7); transform: scale(1); }
            50% { box-shadow: 0 0 0 12px rgba(234, 179, 8, 0); transform: scale(1.05); }
            100% { box-shadow: 0 0 0 0 rgba(234, 179, 8, 0); transform: scale(1); }
        }
        /* Clase para el pulso amarillo de descarga en YouTube */
        .btn-playing-download {
            animation: pulse-yellow 1.5s infinite !important;
            background-color: #eab308 !important;
            color: black !important;
        }
        .main-content { padding: 12px 12px 100px 12px; }
        .skeleton {
            background: linear-gradient(90deg, #1f2937 25%, #374151 50%, #1f2937 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
        }
        @keyframes loading { 0% { background-position: 200% 0; } 100% { background-position: -200% 0; } }
        .carousel-wrapper {
            display: flex;
            overflow-x: auto;
            scroll-snap-type: x mandatory;
            gap: 12px;
            padding: 8px 0;
            scrollbar-width: none;
        }
        .carousel-wrapper::-webkit-scrollbar { display: none; }
        .carousel-item { flex: 0 0 75%; width: 75%; scroll-snap-align: center; }
        @media (min-width: 640px) { .carousel-item { flex: 0 0 35%; width: 35%; } }
        .modal-overlay { display: none; position: fixed; inset: 0; z-index: 2000; background: rgba(0, 0, 0, 0.92); backdrop-filter: blur(12px); }
        .modal-overlay.active { display: flex; }
        @keyframes wa-pulse { 0% { box-shadow: 0 0 0 0 rgba(37, 211, 102, 0.7); } 70% { box-shadow: 0 0 0 15px rgba(37, 211, 102, 0); } 100% { box-shadow: 0 0 0 0 rgba(37, 211, 102, 0); } }
        .wa-launcher { position: fixed; bottom: 25px; left: 20px; background-color: var(--wa-color); width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; box-shadow: 0 4px 12px rgba(0,0,0,0.3); z-index: 10000; animation: wa-pulse 2s infinite; transition: transform 0.3s ease; }
        .wa-launcher:active { transform: scale(0.9); }
        .wa-badge { position: absolute; top: -2px; right: -2px; background: #ff0000; color: white; border-radius: 50%; width: 22px; height: 22px; font-size: 12px; font-weight: bold; display: flex; align-items: center; justify-content: center; border: 2px solid white; }
        .wa-card { position: fixed; top: 20px; right: 20px; width: 320px; background: white; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.25); display: none; flex-direction: column; z-index: 10001; font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; overflow: hidden; transition: top 0.3s ease; }
        .wa-header { background: var(--wa-dark); color: white; padding: 15px; display: flex; justify-content: space-between; align-items: center; }
        .wa-header-info b { display: block; font-size: 15px; }
        .wa-header-info span { font-size: 12px; opacity: 0.9; }
        .wa-close { cursor: pointer; font-size: 24px; line-height: 1; }
        .wa-body { padding: 15px; background: var(--wa-bg-chat); max-height: 200px; min-height: 80px; overflow-y: auto; }
        .wa-bubble { background: white; padding: 12px; border-radius: 10px; font-size: 14px; color: #333; border-top-left-radius: 0; position: relative; box-shadow: 0 1px 2px rgba(0,0,0,0.1); }
        .typing { font-style: italic; color: #777; font-size: 13px; display: none; }
        .wa-footer { padding: 10px; background: #f0f0f0; display: flex; gap: 8px; align-items: center; }
        .wa-input { flex: 1; border: 1px solid #ccc; border-radius: 25px; padding: 10px 15px; outline: none; font-size: 16px; color: black; }
        .wa-send { background: var(--wa-color); border: none; color: white; width: 40px; height: 40px; border-radius: 50%; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: background 0.2s; }
        .wa-send:hover { background: var(--wa-dark); }
        @media (max-width: 480px) { .wa-card { width: 90%; right: 5%; top: 10px; } }
        #modal-search-input::placeholder { color: rgba(255, 255, 255, 0.4); text-transform: uppercase; font-weight: 800; letter-spacing: 0.05em; }
        
        #iptv-player { display: none; width: 100%; height: 100%; object-fit: contain; }
    </style>
</head>

<body class="select-none overflow-x-hidden">

<div class="wa-card" id="waCard">
  <div class="wa-header">
    <div class="wa-header-info">
      <b>Soporte en l铆nea</b>
      <span id="waStatus">Cargando estado...</span>
    </div>
    <div class="wa-close" onclick="toggleChat()"></div>
  </div>
  <div class="wa-body">
    <div id="waTyping" class="wa-bubble typing">Escribiendo...</div>
    <div id="waMsg" class="wa-bubble" style="display:none;">
        <b><center><span id="pageTarget">esta p谩gina</span></center></b><br>
        HOLA !! <br>SI NO ENCONTRASTE LO QUE BUSCAS ...
        DIME CUAL QUIERES VER Y PRONTO LA PODRAS DESCARGAR AQUI
    </div>
  </div>
  <div class="wa-footer">
    <input type="text" id="waInput" class="wa-input" placeholder="Escribe tu mensaje ...">
    <button class="wa-send" onclick="sendToWhatsapp()">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="white"><path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/></svg>
    </button>
  </div>
</div>

<div class="wa-launcher" id="waLauncher" onclick="toggleChat()">
  <div class="wa-badge" id="waBadge">1</div>
  <img src="https://upload.wikimedia.org/wikipedia/commons/6/6b/WhatsApp.svg" width="32" alt="WhatsApp">
</div>

    <!-- Modales -->
    <div id="news-modal" class="modal-overlay items-center justify-center p-4">
        <div class="glass w-full max-w-md rounded-3xl overflow-hidden shadow-2xl">
            <div class="p-4 border-b border-white/10 flex justify-between items-center bg-white/5">
                <h3 class="text-md font-extrabold text-yellow-400 flex items-center gap-2">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-7.714 2.143L11 21l-2.286-6.857L1 12l7.714-2.143L11 3z"/></svg>
                    NOVEDADES
                </h3>
                <button onclick="closeNewsModal()" class="p-2 hover:bg-white/10 rounded-full transition">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M6 18L18 6M6 6l12 12" stroke-width="2.5"/></svg>
                </button>
            </div>
            <div id="news-list" class="p-3 space-y-2 max-h-[40vh] overflow-y-auto"></div>
            <div class="p-5 pt-2 bg-black/20 text-center">
                <p class="text-[12px] text-gray-300 font-medium">Si te gusta el contenido</p>
                <p class="text-[12px] text-gray-300 font-medium">Considera apoyarnos con una donaci贸n</p>
                <p class="text-[12px] text-gray-300 font-medium" style="color:#FF5733;">!!TU AYUDA MANTIENE VIVO ESTE PROYECTO!!</p>
                <button onclick="window.open('https://paypal.me/marzam', '_blank')" class="w-full h-10 glass hover:bg-white/10 rounded-xl transition-all flex items-center justify-center p-2 border-yellow-500/20 shadow-lg mt-2">
                    <img src="https://drive.google.com/thumbnail?id=1UFiNxdjFMg0-EQM0yCZR-L0x6cShoyWZ" alt="Paypal" class="h-full object-contain" />
                </button>
            </div>
        </div>
    </div>

    <div id="search-modal" class="modal-overlay items-center justify-center p-4">
        <div class="glass w-full max-w-2xl rounded-3xl overflow-hidden shadow-2xl flex flex-col max-h-[85vh]">
            <div class="p-4 border-b border-white/10 flex items-center gap-3 bg-white/5">
                <div class="flex items-center gap-2 flex-grow min-w-0">
                    <span class="w-1.5 h-6 bg-blue-600 rounded-full flex-shrink-0"></span>
                    <input type="text" id="modal-search-input" class="w-full bg-transparent border-none text-sm font-black text-white uppercase tracking-widest outline-none placeholder:text-gray-600" placeholder="BUSCAR MS..." />
                </div>
                <button onclick="closeSearchModal()" class="p-2 hover:bg-white/10 rounded-full transition flex-shrink-0">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M6 18L18 6M6 6l12 12" stroke-width="2.5"/></svg>
                </button>
            </div>
            <div id="search-results-grid" class="p-4 grid grid-cols-2 sm:grid-cols-3 gap-4 overflow-y-auto"></div>
            <div id="search-empty" class="p-10 text-center hidden">
                <p class="text-gray-500 text-xs italic">No hay coincidencias...</p>
            </div>
        </div>
    </div>

    <div class="sticky-header">
        <div class="max-w-screen-xl mx-auto">
            <div class="video-container overflow-hidden">
                <div id="youtube-player" class="absolute inset-0 w-full h-full"></div>
                <video id="iptv-player" class="absolute inset-0 w-full h-full" controls autoplay playsinline></video>
            </div>
            
            <div class="controls-bar glass flex items-center gap-2 px-2 mx-1">
                <button onclick="toggleFullScreen()" class="p-1.5 text-blue-400 hover:text-white transition-colors" title="Pantalla Completa">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"/></svg>
                </button>

                <div class="relative flex-grow">
                    <input type="text" id="image-search-input" placeholder="Buscar..." class="w-full bg-black/40 border border-white/10 rounded-lg py-1 pl-3 pr-8 text-[11px] focus:ring-1 focus:ring-blue-500 outline-none transition-all placeholder:text-gray-500" />
                    <button id="clear-search" class="absolute right-1.5 top-1/2 -translate-y-1/2 text-red-500 p-0.5" onclick="closeSearchModal()">
                        <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M6 18L18 6M6 6l12 12" stroke-width="3"/></svg>
                    </button>
                </div>
                <!-- Bot贸n de Acci贸n Principal -->
                <button id="action-button" class="bg-blue-600 hover:bg-blue-500 text-white font-bold px-3 py-1.5 rounded-lg flex items-center justify-center gap-1.5 transition active:scale-95 text-[10px]">
                    <span id="btn-text">TERABOX</span>
                    <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" stroke-width="2.5"/></svg>
                </button>
            </div>
        </div>
    </div>

    <div class="main-content max-w-screen-xl mx-auto">
        <div id="original-carousels-section" class="space-y-6"></div>
    </div>
    
    <button onclick="window.open('https://paypal.me/marzam', '_blank')" class="fixed bottom-6 right-6 z-50 glass p-1 rounded-2xl hover:scale-110 active:scale-90 transition-all shadow-2xl">
        <img src="https://drive.google.com/thumbnail?id=1UFiNxdjFMg0-EQM0yCZR-L0x6cShoyWZ" alt="PayPal" class="h-8 w-auto" />
    </button>
    
    <script>
    var player;
    var isPlayerReady = false;
    var firstVideoId = '';
    var isCurrentIPTV = false; // Estado para saber si estamos en modo IPTV
    const iptvPlayer = document.getElementById('iptv-player');
    const ytElement = document.getElementById('youtube-player');
    const btnText = document.getElementById('btn-text');
    const actionBtn = document.getElementById('action-button');

    // YouTube API
    var tag = document.createElement('script');
    tag.src = "https://www.youtube.com/iframe_api";
    var firstScriptTag = document.getElementsByTagName('script')[0];
    firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

    function onYouTubeIframeAPIReady() {
        player = new YT.Player('youtube-player', {
            height: '100%', width: '100%', videoId: firstVideoId,
            playerVars: { 'autoplay': 0, 'rel': 0, 'enablejsapi': 1 },
            events: { 'onReady': onPlayerReady, 'onStateChange': onPlayerStateChange }
        });
    }

    function onPlayerReady(event) { isPlayerReady = true; }

    function onPlayerStateChange(event) {
        // Solo aplicar cambios si NO es IPTV
        if (isCurrentIPTV) return;

        if (event.data == YT.PlayerState.PLAYING) {
            actionBtn.classList.add('btn-playing-download');
            btnText.innerText = "DESCARGALA COMPLETA AQUI POR TERABOX";
        } else {
            actionBtn.classList.remove('btn-playing-download');
            btnText.innerText = "TERABOX";
        }
    }

    function playIPTV(url) {
        isCurrentIPTV = true;
        // Limpiar estilos de YouTube si existieran
        actionBtn.classList.remove('btn-playing-download');
        btnText.innerText = "IPTV";

        ytElement.style.display = 'none';
        iptvPlayer.style.display = 'block';
        if (player && player.stopVideo) player.stopVideo();

        if (Hls.isSupported() && url.includes('.m3u8')) {
            const hls = new Hls();
            hls.loadSource(url);
            hls.attachMedia(iptvPlayer);
            hls.on(Hls.Events.MANIFEST_PARSED, function() {
                iptvPlayer.play();
            });
        } else {
            iptvPlayer.src = url;
            iptvPlayer.play();
        }
    }

    function selectMedia(item) {
        const url = getRandomValue(item.streamUrl || "");
        const ytId = getRandomValue(item.youtubeId || "");

        if (url && (url.includes('.m3u8') || url.includes('.mp4') || url.includes('.m3u'))) {
            playIPTV(url);
        } else if (ytId) {
            isCurrentIPTV = false;
            iptvPlayer.style.display = 'none';
            iptvPlayer.pause();
            ytElement.style.display = 'block';
            
            // Resetear bot贸n a estado original
            btnText.innerText = "TERABOX";
            actionBtn.classList.remove('btn-playing-download');

            if (isPlayerReady && player && player.loadVideoById) {
                player.loadVideoById({ 'videoId': ytId });
            } else {
                firstVideoId = ytId;
            }
        }

        currentUrl = item.buttonId ? `https://1024terabox.com/s/${item.buttonId}` : 'https://www.terabox.com/';
        localStorage.setItem('lastViewed', JSON.stringify(item));
        closeNewsModal();
        closeSearchModal();
        if (!document.fullscreenElement) toggleFullScreen();
    }

    function toggleFullScreen() {
        const docEl = document.documentElement;
        if (!document.fullscreenElement) {
            if (docEl.requestFullscreen) docEl.requestFullscreen().catch(e => console.warn(e));
        } else {
            if (document.exitFullscreen) document.exitFullscreen();
        }
    }

    function getRandomValue(val) {
        if (Array.isArray(val)) return val[Math.floor(Math.random() * val.length)];
        return val;
    }

    const allData = {
        'pelic': {
            title: 'SERIES Y PELICULAS', carousels: [ {
                id: 'Pel铆culas1', data: [ 
                    { id: '1ATOJcg4vQJPMmoMCzqlQTxEr-vlhBzQY', youtubeId: 'jla6YMfkS9Q', buttonId: '1mvtGF4bUXIjNOlU5DLbsBw', title: '2 BROKE GIRLS', subtitle: '2 Chicas Quebradas (2011-16)', subtitle2: '6 Temporadas 138 Episodios', buscar: 'P3L02' }, 
                    { id: '1r2ppXqrB2LELgK6aGbOuwbFCywdzkfL-', youtubeId: 'BEsL884-zKQ', buttonId: '1nqfcrwkASrg9WL5P6lwE9Q', title: '2 HEARTS', subtitle: '2 Corazones (2020)', buscar: 'BUSCAR' },
                    { id: '1YHx1xAuPOkPIX4T_lrwlJyFc4mkF-CSS', youtubeId: 'heOcee5ZB9c', buttonId: '1sa2uaoP8BBVf45XYfkokIA', title: '3 METROS SOBRE EL CIELO', subtitle: '3 Metros Sobre El Cielo', buscar: 'BUSCAR' },
                    { id: '1vm-Z65jtoTdz1tv-NnqxBxjBOGu6Pimo', youtubeId: 'ucmnTmYpGhI', buttonId: '1hjwcoKc3OHkVkxwGsGXUJQ', title: 'YOU DON\'T MESS WITH THE ZOHAN', subtitle: 'No Te Metas Con Zohan (2008)', buscar: 'Adam Sandler' }
                ] }
            ] },
        'estrenos': {
            title: 'MAS RECIENTE', carousels: [ {
                id: 'Pel铆culas2', data: [ 
                    { id: '1_8su9YgJ42xCpehpZkYII1nua-mlQWOO', youtubeId: 'wg8_JUvvRgg', buttonId: '1S8OkwTCXViFarJ85XyRvbw', title: 'LAND OF SIN', subtitle: 'La Tierra Del Pecado) (2026)', buscar: 'P3ROIZ' },
                    { id: '10xgFzQ3pTyAeh_OpH-L7fLKiL3N-2XCH', youtubeId: 'yFzSe2Nuys4', buttonId: '1kcjXOAuOGd2cBJ6F9jpnlg', title: 'CHEETAHS UP CLOSE WITH BERTIE GREGORY', subtitle: 'Guepardos En Primer Plano Con Bertie Gregory (2026)', buscar: 'P3ROIZ' }
                ] }
            ] },
        'canales': {
            title: 'TV (IPTV)', carousels: [ {
                id: 'IPTV1', data: [ 
                    { id: '1VcfHjD8Z6bjZk0B8SHCQ2lLRwR5VDHOj', streamUrl: 'https://test-streams.mux.dev/x36xhzz/x36xhzz.m3u8', title: 'CANAL DE PRUEBA HLS', subtitle: 'Transmisi贸n en vivo m3u8', buscar: 'tv, vivo, iptv' },
                    { id: '1GUENgqotu2IFlgoISlNF_xcw9QlHoq7N', streamUrl: 'https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4', title: 'VIDEO MP4 DIRECTO', subtitle: 'Servidor Premium', buscar: 'mp4, directo' }                       
                ] }
            ] }
    };

    const allImages = Object.values(allData).flatMap(c => c.carousels.flatMap(car => car.data));
    let currentUrl = 'https://www.terabox.com/';

    function cleanText(text) {
        if (!text) return "";
        return text.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g, "").replace(/[^a-z0-9]/g, "").trim();
    }

    document.getElementById('image-search-input').addEventListener('input', (e) => filterData(e.target.value));
    document.getElementById('modal-search-input').addEventListener('input', (e) => filterData(e.target.value));

    function filterData(query) {
        const q = cleanText(query);
        const searchModal = document.getElementById('search-modal');
        const resultsGrid = document.getElementById('search-results-grid');
        const emptyMsg = document.getElementById('search-empty');
        
        if (q.length > 0) {
            const results = allImages.filter(i => 
                cleanText(i.title).includes(q) || cleanText(i.buscar).includes(q)
            );
            searchModal.classList.add('active');
            resultsGrid.innerHTML = '';
            if (results.length > 0) {
                emptyMsg.classList.add('hidden');
                results.forEach(item => {
                    const thumbId = getRandomValue(item.id);
                    const div = document.createElement('div');
                    div.className = 'cursor-pointer group flex flex-col gap-1.5';
                    div.onclick = () => selectMedia(item);
                    div.innerHTML = `<div class="relative overflow-hidden rounded-xl bg-gray-900 aspect-video"><img src="https://drive.google.com/thumbnail?id=${thumbId}" class="w-full h-full object-cover"/></div><h4 class="text-[9px] font-bold truncate uppercase">${item.title}</h4>`;
                    resultsGrid.appendChild(div);
                });
            } else { emptyMsg.classList.remove('hidden'); }
        } else { closeSearchModal(); }
    }

    function closeSearchModal() { document.getElementById('search-modal').classList.remove('active'); }

    function renderCarousel(container, data) {
        data.forEach(item => {
            const thumbId = getRandomValue(item.id);
            const div = document.createElement('div');
            div.className = 'carousel-item group cursor-pointer';
            div.onclick = () => selectMedia(item);
            div.innerHTML = `<div class="relative overflow-hidden rounded-xl bg-gray-900 aspect-video"><img src="https://drive.google.com/thumbnail?id=${thumbId}" class="w-full h-full object-cover"/></div><h4 class="text-[10px] font-bold truncate mt-1">${item.title}</h4>`;
            container.appendChild(div);
        });
    }

    function showNews() {
        const estrenos = allData.estrenos.carousels[0].data;
        const list = document.getElementById('news-list');
        list.innerHTML = '';
        estrenos.forEach(item => {
            const div = document.createElement('div');
            div.className = "flex items-center gap-3 bg-white/5 p-2 rounded-xl cursor-pointer";
            div.onclick = () => selectMedia(item);
            div.innerHTML = `<img src="https://drive.google.com/thumbnail?id=${getRandomValue(item.id)}" class="w-12 h-8 object-cover rounded" /><div class="flex-1 min-w-0"><p class="text-white text-[10px] font-black truncate">${item.title}</p></div>`;
            list.appendChild(div);
        });
        document.getElementById('news-modal').classList.add('active');
    }

    function closeNewsModal() { document.getElementById('news-modal').classList.remove('active'); }

    document.addEventListener('DOMContentLoaded', () => {
        const section = document.getElementById('original-carousels-section');
        Object.values(allData).forEach(cat => {
            const div = document.createElement('div');
            div.className = 'mb-5';
            div.innerHTML = `<h2 class="text-xs font-black mb-1.5 px-2 text-gray-400 border-l-2 border-blue-600 ml-1 uppercase"> ${cat.title}</h2>`;
            cat.carousels.forEach(c => {
                const wrap = document.createElement('div');
                wrap.className = 'carousel-wrapper';
                renderCarousel(wrap, c.data);
                div.appendChild(wrap);
            });
            section.appendChild(div);
        });
        
        const saved = localStorage.getItem('lastViewed');
        if (saved) selectMedia(JSON.parse(saved));
        else if (allImages.length > 0) selectMedia(allImages[0]);
        setTimeout(showNews, 1500);
    });

    actionBtn.onclick = () => window.open(currentUrl, '_blank');

    // WhatsApp
    function toggleChat() {
        const card = document.getElementById('waCard');
        card.style.display = (card.style.display === 'flex') ? 'none' : 'flex';
        if(card.style.display === 'flex') {
            document.getElementById('waMsg').style.display = 'block';
        }
    }
    function sendToWhatsapp() {
        const val = document.getElementById('waInput').value;
        if(val) window.open(`https://wa.me/525621896010?text=${encodeURIComponent(val)}`, '_blank');
    }
    </script>
</body>
</html>

